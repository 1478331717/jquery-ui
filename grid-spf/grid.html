<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Grid: Data</title>
	<link rel="stylesheet" href="../themes/base/jquery.ui.all.css">
	<link rel="stylesheet" href="grid.css">
	<script src="../jquery-1.5.1.js"></script>
	<script src="../external/jquery.tmpl.js"></script>
	<script src="../ui/jquery.ui.core.js"></script>
	<script src="../ui/jquery.ui.widget.js"></script>
	<script src="datasource.js"></script>
	<script src="grid.js"></script>

	<script>

	var localDevelopers = [
		{
			firstName: "Scott",
			lastName: "González",
			country: "USA",
			twitter: "scott_gonzalez",
			github: "scottgonzalez"
		},
		{
			firstName: "Richard",
			lastName: "Worth",
			country: "USA",
			twitter: "rworth",
			github: "rdworth"
		},
		{
			firstName: "Jörn",
			lastName: "Zaefferer",
			country: "Germany",
			twitter: "bassistance",
			github: "jzaefferer"
		},
		{
			firstName: "Carl",
			lastName: "Worth",
			country: "Canada",
			twitter: "cworth",
			github: "cworth"
		}
	];
	
	$.fn.filter = function(datasource) {
		var filtered = {};
		this.addClass("filter").find("input").click(function() {
			var field = $(this).data("filter-field"),
				value = $(this).data("filter-value"),
				operator = $(this).data("filter-operator");
			if (filtered[field]) {
				delete filtered[field];
			} else {
				filtered[field] = {
					property: field,
					value: value,
					operator: operator
				};
			}
			var filter = [];
			for (var key in filtered) {
				filter.push(filtered[key]);
			}
			datasource.option("filter", filter).refresh();
			
			$(this).toggleClass("filtered");
		})
		return this;
	}

	$(function() {
		var developers = $.dataSource({
			source: localDevelopers
		});
		
		var dev2 = $.ui.datasource({
			source: localDevelopers
		})
		//console.log(dev2.toArray());

		$( "#developers-local" ).grid({
			columns: [ "firstName", "lastName", "country" ],
			source: developers
		});
		
		// Dynamically configure the query options on the dataSource.  refresh() to update the array contents.
		var filtered = {};
		$("#filterDevelopers").filter(developers);
		
		// A similar example...but with server integration and remote queries.
		var movies = $.dataSource($.extend({}, $.dataSource.oDataSettings, {
			path: "http://odata.netflix.com/Catalog/Titles",
			paging: { take: 10 },
			jsonp: "$callback"
		}));
		$( "#movies" ).grid({
			source: movies
		});

		$("#filterMovies").filter(movies);
	});
	</script>
	
	<style>
		.filter input {
			border: 1px solid white;
		}
		.filter input.filtered {
			border: 1px solid black;
		}
	</style>
</head>
<body>


<h2>local data source</h2>
<p id="filterDevelopers">
	<input data-filter-field="firstName" data-filter-value="Scott" type="button" value="Toggle firstName=Scott"/>
	<input data-filter-field="lastName" data-filter-value="Worth"  type="button" value="Toggle lastName=Worth"/>
	<input data-filter-field="country" data-filter-value="USA" type="button" value="Toggle country=USA"/>
</p>
<p>
<table id="developers-local">
	<thead>
		<tr>
			<th data-field="firstName">First Name</th>
			<th data-field="lastName">Last Name</th>
			<th data-field="country">Country</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
</table>
</p>


<h2>remote data source</h2>
<p id="filterMovies">
	<input data-filter-field="AverageRating" data-filter-operator=">" data-filter-value="3" type="button" value="Toggle AverageRating > 3"/>
	<input data-filter-field="ReleaseYear" data-filter-operator="<="  data-filter-value="1990"  type="button" value="Toggle ReleaseYear <= 1990"/>
	<input data-filter-field="Name" data-filter-operator="like"  data-filter-value="ultra"  type="button" value="Toggle Name like 'ultra'"/>
</p>
<p>
<table id="movies">
	<thead>
		<tr>
			<th data-field="Name">Name</th>
			<th data-field="ReleaseYear">Release Year</th>
			<th data-field="AverageRating">Average Rating</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
</table>
</p>

</body>
</html>
